<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.siruiman.crosslogistics.mapper.LogisticInfoMapper">
    <resultMap id="BaseResultMap" type="com.siruiman.crosslogistics.model.LogisticInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="logistic_info_id" property="logisticInfoId" jdbcType="INTEGER"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="goods_id" property="goodsId" jdbcType="INTEGER"/>
        <result column="bag_id" property="bagId" jdbcType="INTEGER"/>
        <result column="operate_result" property="operateResult" jdbcType="VARCHAR"/>
        <result column="operate_type" property="operateType" jdbcType="VARCHAR"/>
        <result column="operate_comment" property="operateComment" jdbcType="VARCHAR"/>
        <result column="parameter" property="parameter" jdbcType="VARCHAR"/>
        <result column="operate_name" property="operateName" jdbcType="VARCHAR"/>
        <result column="staff_id" property="staffId" jdbcType="INTEGER"/>
        <result column="app_user_id" property="appUserId" jdbcType="INTEGER"/>
        <result column="admin_uid" property="adminUid" jdbcType="INTEGER"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from logistic_info
        where logistic_info_id = #{logisticInfoId,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.siruiman.crosslogistics.model.LogisticInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <selectKey resultType="java.lang.Integer" keyProperty="logisticInfoId" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
        insert into logistic_info (create_time, goods_id, bag_id,
        operate_result, operate_type, operate_comment,
        `parameter`,operate_name,staff_id,app_user_id,admin_uid)
        values (#{createTime,jdbcType=TIMESTAMP}, #{goodsId,jdbcType=INTEGER}, #{bagId,jdbcType=INTEGER},
        #{operateResult,jdbcType=VARCHAR}, #{operateType,jdbcType=VARCHAR}, #{operateComment,jdbcType=VARCHAR},
        #{parameter,jdbcType=VARCHAR},#{operateName,jdbcType=VARCHAR},#{staffId,jdbcType=INTEGER},
        #{appUserId,jdbcType=INTEGER}, #{adminUid,jdbcType=INTEGER})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.siruiman.crosslogistics.model.LogisticInfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update logistic_info
        set create_time = #{createTime,jdbcType=TIMESTAMP},
        goods_id = #{goodsId,jdbcType=INTEGER},
        bag_id = #{bagId,jdbcType=INTEGER},
        operate_result = #{operateResult,jdbcType=VARCHAR},
        operate_type = #{operateType,jdbcType=VARCHAR},
        operate_comment = #{operateComment,jdbcType=VARCHAR},
        `parameter` = #{parameter,jdbcType=VARCHAR},
        operate_name = #{operate_name,jdbcType=VARCHAR},
        staff_id = #{staffId,jdbcType=INTEGER},
        app_user_id = #{appUserId,jdbcType=INTEGER},
        admin_uid = #{adminUid,jdbcType=INTEGER}
        where logistic_info_id = #{logisticInfoId,jdbcType=INTEGER}
    </update>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info
        where logistic_info_id = #{logisticInfoId,jdbcType=INTEGER}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info
    </select>
    <select id="selectGoodsLogisticInfoByGoodsId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info where goods_id = #{goodsId,jdbcType=INTEGER}
        ORDER BY create_time DESC
    </select>
    <select id="selectOperateNameById" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info where goods_id = #{goodsId,jdbcType=INTEGER}
        ORDER BY create_time DESC
    </select>
    <select id="selectOperateNameCount" resultType="java.lang.Integer" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select COUNT(logistic_info_id)
        from logistic_info where goods_id = #{goodsId,jdbcType=INTEGER}
        ORDER BY create_time DESC
    </select>
    <select id="selectPieceByStaffId" resultType="java.lang.Integer" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select COUNT(logistic_info_id)
        from logistic_info where staff_id = #{staffId,jdbcType=INTEGER}
    </select>
    <select id="selectLogisticInfoBystaffId" resultMap="BaseResultMap">
     select logistic_info_id,create_time,operate_type,operate_comment
     from logistic_info WHERE staff_id = #{staffId,jdbcType=INTEGER} AND create_time >= #{firstDayOfMonth} AND create_time &lt;= #{lastDayOfMonth}
     ORDER BY create_time ASC
  </select>

    <select id="selectCountLogisticInfoBystaffId" resultType="java.lang.Integer">
     select count(logistic_info_id) AS count
     from logistic_info WHERE staff_id = #{staffId,jdbcType=INTEGER} AND create_time >= #{firstDayOfMonth} AND create_time &lt;= #{lastDayOfMonth}
     ORDER BY create_time ASC
  </select>
    <select id="selectBagLogisticInfoByBagId" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info where bag_id = #{bagId,jdbcType=INTEGER}
        ORDER BY create_time DESC
    </select>
    <select id="selectBagOperateNameCount" resultType="java.lang.Integer" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select COUNT(logistic_info_id)
        from logistic_info where bag_id = #{bagId,jdbcType=INTEGER}
        ORDER BY create_time DESC
    </select>
    <select id="selectBagId" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info where bag_id = #{bagId} AND operate_type = #{OperateType}
    </select>
    <select id="selectGoodsLogisticInfoByIdType" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id,admin_uid
        from logistic_info where goods_id = #{goodsId} AND operate_type = #{OperateType}
    </select>
    <select id="selectLogisticInfoByGoodsId" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
        operate_comment, `parameter`,operate_name,staff_id,app_user_id
        from logistic_info where goods_id = #{goodsId}
        ORDER BY logistic_info_id DESC LIMIT 1
    </select>

    <select id="selectLogisticInfoByBagId" resultMap="BaseResultMap">
     select logistic_info_id, create_time, goods_id, bag_id, operate_result, operate_type,
    operate_comment, `parameter`,operate_name,staff_id,app_user_id
    from logistic_info where bag_id = #{bagId}
    ORDER BY logistic_info_id DESC LIMIT 1
  </select>
    <!--根据货物单号查询货物进程-->
    <select id="selectLogisticInfoByDeliveryNum" resultMap="BaseResultMap">
    SELECT
	lgfo.create_time ,lgfo.operate_result
    FROM
	logistic_info AS lgfo
    LEFT JOIN goods AS gd ON lgfo.goods_id = gd.goods_id
    WHERE gd.delivery_number = #{deliveryNum}
    ORDER BY lgfo.create_time DESC
  </select>
    <select id="selectLogisticInfoByTripartiteNumber" resultType="com.siruiman.crosslogistics.model.LogisticInfo2">
    SELECT
	lgfo.create_time,lgfo.operate_result,gd.goods_id,substring_index(gd.delivery_number,'-',-1) AS numOfBoxes
    FROM
	logistic_info AS lgfo
    LEFT JOIN goods AS gd ON lgfo.goods_id = gd.goods_id
    WHERE gd.tripartite_number = #{tripartiteNumber}
    ORDER BY gd.goods_id ASC, lgfo.create_time DESC
  </select>

    <select id="selectLogisticInfo" resultType="com.siruiman.crosslogistics.model.LogisticInfo2">
    SELECT
	lgfo.create_time,lgfo.operate_result,gd.goods_id
    FROM
	logistic_info AS lgfo
    LEFT JOIN goods AS gd ON lgfo.goods_id = gd.goods_id
    WHERE gd.tripartite_number = #{tripartiteNumber}
    ORDER BY gd.goods_id ASC, lgfo.create_time DESC
  </select>

    <select id="selectLogisticInfoBystaffIdList" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select li.logistic_info_id, li.create_time, li.goods_id, li.bag_id, li.operate_result, li.operate_type,
        li.operate_comment, li.`parameter`,li.operate_name,li.staff_id,li.app_user_id,li.admin_uid
        from logistic_info as li
        left join goods on (li.goods_id =goods.goods_id)
        <where>
            <if test="operateType != null and operateType != ''">
                AND li.operate_type like "%"#{operateType}"%"
            </if>
            <if test="staffId != null and staffId != ''">
                AND li.staff_id = #{staffId}
            </if>
            <if test="startDate != null and startDate != ''">
                AND goods.add_time >= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND goods.add_time &lt;= #{endDate}
            </if>
        </where>
    </select>

    <select id="selectLogisticInfoByadminUidList" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select li.logistic_info_id, li.create_time, li.goods_id, li.bag_id, li.operate_result, li.operate_type,
        li.operate_comment, li.`parameter`,li.operate_name,li.staff_id,li.app_user_id,li.admin_uid
        from logistic_info as li
        left join goods on (li.goods_id =goods.goods_id)
        <where>
            <if test="operateType != null and operateType != ''">
                AND li.operate_type like "%"#{operateType}"%"
            </if>
            <if test="adminUid != null and adminUid != ''">
                AND li.admin_uid = #{adminUid}
            </if>
            <if test="startDate != null and startDate != ''">
                AND goods.add_time >= #{startDate}
            </if>
            <if test="endDate != null and endDate != ''">
                AND goods.add_time &lt;= #{endDate}
            </if>
        </where>
    </select>
</mapper>